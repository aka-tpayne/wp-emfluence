emfluenceEmailerWidget={init:function(){jQuery(".wp-emfluence").accordion({heightStyle:"content",collapsible:!0,active:!1})},groups:{add:function(e){$widget=jQuery(e).parents(".widget"),$input=this.getInput($widget);var t=this.processValue($input.val());if(t){if($checkboxesContainer=this.getCheckboxesContainer($widget),$checkboxesContainer.find('input[type="checkbox"][value="'+t.id+'"]').length>0)return void alert(t.name+" is already in the selected groups.");$checkboxesContainer.append(this.createCheckbox($widget,t)),$input.val(null)}},getInput:function(e){return e.find(".groups input[list]")},getCheckboxesContainer:function(e){return e.find(".groups .selected")},processValue:function(e){var t=e.match(/(.+)\s\[(\d+)\]/);return t?{name:t[1],id:t[2]}:!1},createCheckbox:function(e,t){var n=e.attr("id").slice(-1),i="groups-"+n+"-"+t.id,a='<div><label for="'+i+'">          <input id="'+i+'" type="checkbox" value="'+t.id+'" name="groups[]" checked /> '+t.name+"        </label></div>";return a}},fields:{add:function(e){$widget=jQuery(e).parents(".widget"),$input=this.getInput($widget);var t=$input.val(),n=$input.find("option:selected").data("settings");return t&&n?($container=this.getContainer($widget),$container.find('[data-variable-key="'+t+'"]').length>0?void alert(n.name+" is already in the selected contact fields."):($container.append(this.createSection($widget,t,n)),void $input.val(null))):console.error("Field not found.")},getInput:function(e){return e.find(".basic-fields-adder select")},getContainer:function(e){return e.find(".basic_contact_fields")},getCustomTemplate:function(e){return e.find(".basic_contact_field_template").html()},createSection:function(e,t,n){var i=1;e.find(".basic_contact_fields .contact-field input.order").each(function(e,t){var n=parseInt(t.value);isNaN(n)||(i=Math.max(i,n))});var a=this.getCustomTemplate(e).replace(new RegExp("CONTACT_FIELD_NAME","g"),n.name).replace(new RegExp("CONTACT_FIELD_KEY","g"),t).replace(new RegExp("CONTACT_FIELD_REQUIRED_MESSAGE","g"),n.required_message).replace(new RegExp("CONTACT_FIELD_LABEL","g"),n.label).replace(new RegExp("CONTACT_FIELD_ORDER","g"),i+1);return a}},variables:{add:function(e){$widget=jQuery(e).parents(".widget"),$input=this.getInput($widget);var t=$input.val();if(t){if($customVariablesContainer=this.getCustomVariablesContainer($widget),$customVariablesContainer.find('[data-variable-key="custom_'+t+'"]').length>0)return void alert(t+" is already in the selected custom variables.");$customVariablesContainer.append(this.createVariableSection($widget,t)),$input.val(null)}},getInput:function(e){return e.find(".custom-variable-adder input")},getCustomVariablesContainer:function(e){return e.find(".custom_variables")},getCustomVariablesTemplate:function(e){return e.find(".custom_variable_template").html()},createVariableSection:function(e,t){var n=this.getCustomVariablesTemplate(e).replace(new RegExp("CUSTOM_VARIABLE_NUMBER","g"),t);return n}}},jQuery(function(){$=jQuery,emfluenceEmailerWidget.init(),$("body").ajaxSuccess(emfluenceEmailerWidget.init)});